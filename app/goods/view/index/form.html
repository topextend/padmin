{extend name="../../admin/view/main"}
{block name="button"}
    <a onClick="javascript:window.history.back();return false;" class="layui-btn layui-btn-sm layui-btn-primary">返回</a>
{/block}
{block name="content"}
{include file='index/formstyle'}
<form onsubmit="return false" data-auto="true" action="{:request()->url()}" method="post" class='layui-form layui-card layui-form-pane' autocomplete="off">
    <div class="layui-card-body">
        <div class="layui-form-item">
            <label class="layui-form-label"><b>商品分类</b></label>
            <div class="layui-input-inline">
                <span class="layui-input">{$select_cats|raw}</span>
            </div>
            <a data-open='{:url("category")}' class="layui-btn layui-btn-radius layui-btn-danger"><span>修改分类</span></a>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label"><b>商品属性</b></label>
            <div class="layui-input-block">        
                <table class="layui-table">                    
                    <thead>
                        <tr>
                            <th class="text-left">请准确填写属性，有利于商品在搜索和推荐中露出，错误填写可能面临商品下架或流量损失!</th>
                        </tr>
                        <tr>
                            <td class="text-left">
                                <div class="layui-row" style="margin-top: 10px;">
                                    <div class="layui-col-md4" style="margin-bottom: 15px;">
                                        <label class="layui-form-label">商品货号</label>
                                        <div class="layui-input-inline">
                                            <input type="text" name="goods_sn" required lay-verify="required" lay-vertype="tips" placeholder="请输入商品货号" autocomplete="off" class="layui-input">
                                        </div>
                                    </div>
                                    <div class="layui-col-md4" style="margin-bottom: 15px;">
                                        <label class="layui-form-label">商品重量</label>
                                        <div class="layui-input-inline">
                                            <input type="text" name="goods_weight" required lay-verify="required" lay-vertype="tips" placeholder="请输入商品重量" autocomplete="off" class="layui-input">
                                        </div>
                                    </div>
                                    <div class="layui-col-md4" style="margin-bottom: 15px;">
                                        <label class="layui-form-label">品牌</label>
                                        <div class="layui-input-inline">
                                            <select name="brand_id" required lay-verify="required" lay-search>
                                                <option value="0">请选择品牌</option>
                                                <!-- {notempty name='goods_brand'} -->
                                                <!-- {foreach $goods_brand as $brand} -->
                                                    <!-- {eq name='brand.id' value='$vo.brand_id|default=0'} -->
                                                        <option selected value='{$brand.id}'>{$brand.brand_name}</option>
                                                    <!-- {else} -->
                                                        <option value='{$brand.id}'>{$brand.brand_name}</option>
                                                    <!-- {/eq} -->
                                                <!-- {/foreach} -->
                                                <!-- {/notempty} -->
                                            </select>
                                        </div>
                                    </div>
                                    <div class="layui-col-md4" style="margin-bottom: 15px;">
                                        <label class="layui-form-label">仓库</label>
                                        <div class="layui-input-inline">
                                            <select name="whouse_id" required lay-verify="required" lay-search>
                                                <option value="0">请选择仓库</option>
                                                <!-- {notempty name='goods_whouses'} -->
                                                <!-- {foreach $goods_whouses as $whouse} -->
                                                    <!-- {eq name='whouse.id' value='$vo.whouse_id|default=0'} -->
                                                        <option selected value='{$whouse.id}'>{$whouse.whouse_name}</option>
                                                    <!-- {else} -->
                                                        <option value='{$whouse.id}'>{$whouse.whouse_name}</option>
                                                    <!-- {/eq} -->
                                                <!-- {/foreach} -->
                                                <!-- {/notempty} -->
                                            </select>
                                        </div>
                                    </div>
                                    <!-- {notempty name='goods_attr'} -->
                                    <!-- {foreach $goods_attr as $key => $attr} -->
                                    <!-- {eq name='attr.attr_type' value='1'} -->
                                    <div class="layui-col-md4" style="margin-bottom: 15px;">
                                        <label class="layui-form-label">{$attr.attr_name}</label>
                                        <div class="layui-input-inline">
                                            <input type="hidden" name='attr_id[]' value="{$attr.id}">
                                            <select name="attr_value[]"class="layui-input layui-unselect">
                                                <option value="0">请选择</option>
                                                <!-- {foreach $attr.attr_values as $value} -->
                                                    <option value='{$value}'>{$value}</option>
                                                <!-- {/foreach} -->
                                            </select>
                                        </div>
                                    </div>
                                    <!-- {/eq} -->
                                    <!-- {/foreach} -->
                                    <!-- {/notempty} -->
                                </div>
                            </td>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label"><b>商品图片</b></label>
            <div class="layui-input-block">
                <table class="layui-table">
                    <thead>
                        <tr>
                            <th class="text-left label-required-prev"><label>轮播图</label></th>
                        </tr>
                        <tr>
                            <td class="text-left">
                                <input name="goods_img" type="hidden" value="{$vo.goods_img|default=''}">
                                <script>$('[name="goods_img"]').uploadMultipleImage();</script>
                            </td>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label"><b>商品规格</b></label>
            <div class="layui-input-block">
                <div ng-repeat="x in specs track by $index" class="margin-bottom-10" ng-class="{true:'layui-show'}[mode==='add'&&specs.length>0]">
                    <div class="goods-spec-box padding-10 margin-0 relative" style="background:#ddd">
                        <span class="text-center goods-spec-title">分组</span>
                        <label class="label-required-null inline-block"></label>
                        <div class="pull-right">
                            <a class="layui-btn layui-btn-sm layui-btn-primary goods-spec-btn" ng-click="addSpecVal(x.list)">增加</a>
                        </div>
                    </div>
                    <div class="goods-spec-box padding-10 margin-0 layui-bg-gray block relative" ng-if="x.list && x.list.length > 0">
                        <label class="label-required-null inline-block margin-right-10 margin-bottom-5 relative nowrap" ng-repeat="xx in x.list">
                            <input type="checkbox" lay-ignore ng-model="xx.check" ng-click="xx.check=checkListChecked(x.list,$event.target.checked)">
                            <input type="text" ng-blur="xx.name=trimSpace(xx.name)" ng-model="xx.name" ng-keyup="xx.name=$event.target.value" required placeholder="请输入规格">
                            <a ng-if="x.list.length>1" ng-click="x.list=delSpecVal(x.list,$index)" class="layui-icon layui-icon-close font-s12 goods-spec-close"></a>
                        </label>
                        <label class="label-required-null inline-block margin-right-10 margin-bottom-5 relative nowrap" ng-repeat="xx in x.list">
                            <input type="checkbox" lay-ignore ng-model="xx.check" ng-click="xx.check=checkListChecked(x.list,$event.target.checked)">
                            <input type="text" ng-blur="xx.name=trimSpace(xx.name)" ng-model="xx.name" ng-keyup="xx.name=$event.target.value" required placeholder="请输入规格">
                            <a ng-if="x.list.length>1" ng-click="x.list=delSpecVal(x.list,$index)" class="layui-icon layui-icon-close font-s12 goods-spec-close"></a>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        {notempty name='vo.id'}<input type='hidden' value='{$vo.id}' name='id'>{/notempty}
        <input type='hidden' value='{:input("cat_id",0)}' name='cat_id'>
        <input type='hidden' value='{:session("user.id")}' name='user_id'>
        <div class="layui-form-item text-center">
            <button class="layui-btn" type='submit'>保存数据</button>
            <button class="layui-btn layui-btn-danger" type='button' data-open='{:url("index")}'>取消编辑</button>
        </div>
    </div>
</form>
{/block}
{block name='script'}
<script>
    /*! 表单初始化 */
    window.form.render();
</script>
{/block}